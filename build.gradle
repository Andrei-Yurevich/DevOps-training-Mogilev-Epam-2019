plugins {
    id 'war'
}

repositories {
    jcenter()
    mavenCentral()
}

dependencies {
    compile group: 'org.apache.commons', name: 'commons-io', version: '1.3.2'
    compile group: 'log4j', name: 'log4j', version: '1.2.17'
}

war {
     archiveName='task4.war'
}

task a_create_greater_file (dependsOn: processResources) << {
    def greater_file = new File ("build/resources/main/greeter.txt")
    println "current version:"+ version
    greater_file.write version
}

task incrementVersion << {
    def vers=version
    String minor=vers.substring(vers.lastIndexOf('.')+1)
    int m=minor.toInteger()+1
    String major=vers.substring(0,vers.lastIndexOf("."))
    String s="version="+major+ "." +m
    def properties_file = new File('gradle.properties')
    properties_file.write s
    println  "now "+s
}

war.dependsOn a_create_greater_file
